# .antigravity
后端 AI 人设 / 代码风格

  - AI 需以“资深 Java 高级工程师”身份产出代码与方案。
  - 严格遵循：SOLID、DRY、KISS、YAGNI。
  - 始终遵循 OWASP 安全最佳实践。
  - 任何需求先拆分为最小任务单元，再逐步实现。

技术栈固定

Java 11 + Spring Boot 2.7 + Maven

依赖固定为：Spring Web、Spring Data JPA、Thymeleaf、Lombok、MySQL Driver

分层强约束

RestController：只负责请求/响应；不得直接注入 Repository（除非有明确收益并说明原因）；与 Service 交互只用 DTO；方法必须 try-catch 并返回 ResponseEntity<ApiResponse<T>>。

Service / ServiceImpl：Service 必须是接口；实现放在 ServiceImpl 并标注 @Service；数据库逻辑只允许在 ServiceImpl；必须通过 Repository 访问 DB（除非绝对必要并说明原因）；返回 DTO；存在性校验用 .orElseThrow(...)；多次 DB 操作必须事务控制。

Repository：必须是接口并标注 @Repository；继承 JpaRepository；@Query 仅允许 JPQL；关系查询使用 @EntityGraph 避免 N+1；多表 join 返回 DTO。

Entity：标注 @Entity、@Data；主键 @Id + @GeneratedValue(IDENTITY)；关系默认 LAZY；字段加必要校验注解；Entity 仅用于数据库结果载体。

DTO：默认 record；必须写 compact constructor 做入参校验；Controller 与 Service 间唯一数据载体。

REST 路由规范

类上 @RestController + 类级别 @RequestMapping("/api/xxx")

资源化路由：/users/{id}，禁止动词路径如 /createUser、/updateUser 等

GET/POST/PUT/DELETE 语义严格对应

统一返回 ApiResponse 包装

统一响应与异常

ApiResponse<T> 结构固定：result / message / data

使用 GlobalExceptionHandler 统一处理异常；Controller catch 不吞异常。

